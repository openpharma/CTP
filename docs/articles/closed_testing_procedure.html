<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Closed Testing Procedure • CTP</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Closed Testing Procedure">
<meta property="og:description" content="CTP">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CTP</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Flowchart.html">Flowchart how to use CTP</a>
    </li>
    <li>
      <a href="../articles/closed_testing_procedure.html">Closed Testing Procedure</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="closed_testing_procedure_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Closed Testing Procedure</h1>
                        <h4 class="author">Paul Jordan</h4>
            
            <h4 class="date">2021-03-13</h4>
      
      
      <div class="hidden name"><code>closed_testing_procedure.Rmd</code></div>

    </div>

    
    
<div id="the-closure-principle" class="section level1">
<h1 class="hasAnchor">
<a href="#the-closure-principle" class="anchor"></a>The Closure Principle</h1>
<p>The closure principle is a way to protect the type-I error from multiple testing. Here, we follow the description in <span class="citation">(Bretz, Hothorn, T., and Westfall, P. 2011)</span>. It consists of four steps:</p>
<ol style="list-style-type: decimal">
<li><p>Definition of a set <span class="math inline">\({H} = \{H_1,\ldots, H_n\}\)</span> of elementary hypotheses.</p></li>
<li><p>Construction of the closure set (“Hypothesis Tree”).</p></li>
</ol>
<p><span class="math display">\[\overline{H} = \left \{ H_I =\bigcap_{i \in I}H_i :  \quad I \subseteq \{1,\ldots,n\} \right \} \]</span> <span class="math display">\[(\text{all intersection hypotheses} H_I ).\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li><p>Construction of a local level-<span class="math inline">\(\alpha\)</span> test for each <span class="math inline">\(H_I \in \overline{H}\)</span>.</p></li>
<li><p>Rejection of <span class="math inline">\(H_i\)</span>, if <em>all</em> null hypotheses <span class="math inline">\(H_I \in \overline{H}\)</span> with <span class="math inline">\(i \in I\)</span> are rejected at at the local level <span class="math inline">\(\alpha\)</span>.</p></li>
</ol>
<div id="adjusted-p-values" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusted-p-values" class="anchor"></a>Adjusted p-values</h2>
<p>As the null hypothesis <span class="math inline">\(H_i\)</span> is rejected only if the null hypotheses <span class="math inline">\(H_I \in \overline{H}\)</span> with <span class="math inline">\(i \in I\)</span> are rejected (see point 4. above), the adjusted p-value <span class="math inline">\(p_{adj;i}\)</span> for <span class="math inline">\(H_i\)</span> is defined as:</p>
<ol style="list-style-type: decimal">
<li>Denote with <span class="math inline">\(p_I\)</span> the p-value for a given intersection hypothesis <span class="math inline">\(H_I, \quad I \subseteq \{1, \ldots,n\}\)</span>.</li>
<li>Then, <span class="math inline">\(p_{adj;i}=\max_\limits{I:i\in I} p_I,\quad i=1,\ldots , n\)</span>.</li>
</ol>
</div>
</div>
<div id="implementation" class="section level1">
<h1 class="hasAnchor">
<a href="#implementation" class="anchor"></a>Implementation</h1>
<p>The package was designed in partcular for treatment comparisons in ANOVA-like situations.</p>
<div id="closure-set" class="section level2">
<h2 class="hasAnchor">
<a href="#closure-set" class="anchor"></a>Closure set</h2>
<p>The hypothesis tree of the closed testing procedure is created using the function <code>IntersectHypotheses</code>.</p>
</div>
<div id="local-tests-for-a-given-hypothesis-tree" class="section level2">
<h2 class="hasAnchor">
<a href="#local-tests-for-a-given-hypothesis-tree" class="anchor"></a>Local tests for a given “hypothesis tree”</h2>
<p>In the case of single hypotheses (i.e. if the hypothesis can be described by a single integer vector e.g. <strong>(1,3,5)</strong> the test (F-Test, Kruskal-Wallis-test, probability test, logrank test, ….) is applied directly.</p>
<p>For combined hypotheses (i.e. for hypotheses described by several non-overlapping integer vectors eg. <strong>(1,2), (3,4)</strong>, The procedure differs for (generalised) linear hypotheses and other tests.</p>
<p>In the case of generalised linear hypotheses, the contrast matrices for the single hypotheses included are combined and these contrasts are tested simultaneously. Henceforth, functions from the package <code>emmeans</code><span class="citation">(Russell and Lenth 2020)</span> are used, as for all othe linear and generalised linear hypotheses. For all other tests, first the p-values <span class="math inline">\(p_1, p_2, \ldots ,p_m\)</span> for the single hypotheses are calculated, and then these are combined by Fisher’s combination rule:</p>
<p>If all <span class="math inline">\(m\)</span> hypotheses are assumed to be independent, the test statistics <span class="math inline">\(X\)</span> follows under <span class="math inline">\(H_0\)</span> a <span class="math inline">\(\chi^2\)</span>-distribution with <span class="math inline">\(2m\)</span> degrees of freedom: <span class="math display">\[ X=-2\sum_{i=1}^{m}\ln(p_i) \sim \chi_{2m}^2\]</span> from which a p-value for the global hypothesis can be easily obtained.</p>
<p>In the case of trend tests, the same type of test is applied for all intermediate single tests.</p>
</div>
<div id="adjusted-p-values-1" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusted-p-values-1" class="anchor"></a>Adjusted p-values</h2>
<p>Finally the p-values for the elementary <em>hypotheses</em> are adjusted by calculating the maximum of the p-values from the hypotheses in the <em>testing set</em> of the respective hypothesis.</p>
<p>The function <code>AnalyseCTP</code> calculates all local p-values and the adjusted p-values for all <em>elementary</em> hypotheses.</p>
<p>With the function <code>Adjust_raw</code>, it is also possible to use p-values that have been calculated by other functions or software to calculate the adjusted p-values.</p>
</div>
<div id="testing-set-for-a-specific-elementary-hypothesis" class="section level2">
<h2 class="hasAnchor">
<a href="#testing-set-for-a-specific-elementary-hypothesis" class="anchor"></a>Testing set for a specific elementary hypothesis</h2>
<p>The testing set for a specific elementary hyothesis can be printed by the function <code>TestingSet</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">CTP</span><span class="op">)</span>
        <span class="va">Pairwise</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IntersectHypotheses.html">IntersectHypotheses</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,
                                        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
    <span class="va">Set24</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TestingSet.html">TestingSet</a></span><span class="op">(</span><span class="va">Pairwise</span>,<span class="st">"[24]"</span><span class="op">)</span>
    <span class="va">Set24</span>
<span class="co">## [1] "[24]"     "[124]"    "[13][24]" "[234]"    "[1234]"</span></code></pre></div>
</div>
<div id="comparing-means" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-means" class="anchor"></a>Comparing means</h2>
<p>The dataframe <code>pasi</code> comprises the changes in PASI-score (Psoriasis Area and Severity Index) from baseline within two month in 72 patients treated with three different doses of Etretin or Placebo in a double blind study.</p>
<p>The elementary hypotheses 1:2, 1:3, 1:4 are tested simultaneously using the F-Test i.e. <span class="math inline">\(H_1: \mu_1=\mu_2\)</span>, <span class="math inline">\(H_2: \mu_1=\mu_3\)</span> and <span class="math inline">\(H_3: \mu_1=\mu_4\)</span> simultaneously. The groups with levels 2,3 and 4 are compared to the control (Placebo) group (level 1). In this specific example, the adjusted and unadjusted p-values are the same. All doses show a significant effect compared to Placebo.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">CTP</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">pasi</span><span class="op">)</span>
<span class="va">three.to.first</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IntersectHypotheses.html">IntersectHypotheses</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/summary.ctp.html">Display</a></span><span class="op">(</span><span class="va">three.to.first</span>,Type<span class="op">=</span><span class="st">"s"</span>,arrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-2-1.png" width="100%"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pasi.ctp.F1</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span><span class="op">(</span><span class="va">three.to.first</span>,<span class="va">pasi.ch</span><span class="op">~</span><span class="va">dose</span>,<span class="va">pasi</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pasi.ctp.F1</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : pasi.ch ~ dose , test : F </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=Placebo, 2=ET.10mg, 3=ET.25mg, 4=ET.50mg </span>
<span class="co">## </span>
<span class="co">## Elementary Hypotheses and p-values</span>
<span class="co">## ----------------------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis raw p-value adj. p-value</span>
<span class="co">##        [12]   4.748e-03    4.748e-03</span>
<span class="co">##        [13]   2.737e-05    1.063e-04</span>
<span class="co">##        [14]   1.826e-06    9.797e-06</span>
<span class="fu"><a href="../reference/summary.ctp.html">Display</a></span><span class="op">(</span><span class="va">pasi.ctp.F1</span><span class="op">)</span></code></pre></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-2-2.png" width="100%"></p>
</div>
<div id="another-hypothesis-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#another-hypothesis-structure" class="anchor"></a>Another hypothesis structure</h2>
<p>Testing the elementary hypotheses 1:2, 2:3, 3:4 simultaneously using the F-Test, i.e. testing <span class="math inline">\(H_1: \mu_1=\mu_2\)</span>, <span class="math inline">\(H_2: \mu_2=\mu_3\)</span> and <span class="math inline">\(H_3: \mu_3=\mu_4\)</span> simultaneously. This provides quite different results (compared to <code>pasi.ctp.F1</code>): No further improvement for higher doses.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dose.steps4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IntersectHypotheses.html">IntersectHypotheses</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/summary.ctp.html">Display</a></span><span class="op">(</span><span class="va">dose.steps4</span>,arr<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">


<span class="va">pasi.ctp.F2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span><span class="op">(</span><span class="va">dose.steps4</span>,<span class="va">pasi.ch</span><span class="op">~</span><span class="va">dose</span>,<span class="va">pasi</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pasi.ctp.F2</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : pasi.ch ~ dose , test : F </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=Placebo, 2=ET.10mg, 3=ET.25mg, 4=ET.50mg </span>
<span class="co">## </span>
<span class="co">## Elementary Hypotheses and p-values</span>
<span class="co">## ----------------------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis raw p-value adj. p-value</span>
<span class="co">##        [12]    0.004748      0.01506</span>
<span class="co">##        [23]    0.113879      0.11388</span>
<span class="co">##        [34]    0.525687      0.52569</span>
<span class="fu"><a href="../reference/summary.ctp.html">Display</a></span><span class="op">(</span><span class="va">pasi.ctp.F2</span><span class="op">)</span></code></pre></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-3-2.png" width="100%"></p>
</div>
<div id="other-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#other-tests" class="anchor"></a>Other tests</h2>
<p>For the same hypothesis structure, other tests can also be used:</p>
<div id="generalized-linear-models" class="section level3">
<h3 class="hasAnchor">
<a href="#generalized-linear-models" class="anchor"></a>Generalized Linear Models</h3>
<p>As an example, a positive response is defined as a change from baseline PASI score greater than 50. The new variable <code>Resp</code> has then the value 1 if <em>pasi.ch &gt; 50</em> or 0 otherwise. The corresponding model is chosen to be a generalised linear model with logit-link, as implemented in <code>glm</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pasi</span><span class="op">$</span><span class="va">Resp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">pasi</span><span class="op">$</span><span class="va">pasi.ch</span> <span class="op">&gt;</span> <span class="fl">50</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>

<span class="va">pasi.ctp_bin</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span><span class="op">(</span><span class="va">three.to.first</span>,<span class="va">Resp</span><span class="op">~</span><span class="va">dose</span>,<span class="va">pasi</span>,test.name<span class="op">=</span><span class="st">"glm"</span>,family<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pasi.ctp_bin</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : Resp ~ dose , test : glm </span>
<span class="co">## </span>
<span class="co">## Test options:  family : binomial    </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=Placebo, 2=ET.10mg, 3=ET.25mg, 4=ET.50mg </span>
<span class="co">## </span>
<span class="co">## Elementary Hypotheses and p-values</span>
<span class="co">## ----------------------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis raw p-value adj. p-value</span>
<span class="co">##        [12]    0.036876     0.036876</span>
<span class="co">##        [13]    0.001952     0.005163</span>
<span class="co">##        [14]    0.001577     0.003370</span></code></pre></div>
</div>
<div id="kruskal-wallis-test-of-trend-for-all-single-hypotheses" class="section level3">
<h3 class="hasAnchor">
<a href="#kruskal-wallis-test-of-trend-for-all-single-hypotheses" class="anchor"></a>Kruskal-Wallis test of trend for all single hypotheses</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pasi.ctp.K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span><span class="op">(</span><span class="va">dose.steps4</span>,<span class="va">pasi.ch</span><span class="op">~</span><span class="va">dose</span>,<span class="va">pasi</span>, test<span class="op">=</span><span class="st">"kruskal"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pasi.ctp.K</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : pasi.ch ~ dose , test : kruskal </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=Placebo, 2=ET.10mg, 3=ET.25mg, 4=ET.50mg </span>
<span class="co">## </span>
<span class="co">## Elementary Hypotheses and p-values</span>
<span class="co">## ----------------------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis raw p-value adj. p-value</span>
<span class="co">##        [12]      0.0235      0.05605</span>
<span class="co">##        [23]      0.1655      0.16554</span>
<span class="co">##        [34]      0.4255      0.42546</span>
<span class="fu"><a href="../reference/summary.ctp.html">Display</a></span><span class="op">(</span><span class="va">pasi.ctp.K</span><span class="op">)</span></code></pre></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
</div>
<div id="jonckheere-terpstra-test-of-trend-for-all-single-hypotheses" class="section level3">
<h3 class="hasAnchor">
<a href="#jonckheere-terpstra-test-of-trend-for-all-single-hypotheses" class="anchor"></a>Jonckheere-Terpstra test of trend for all single hypotheses</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pasi.ctp.J1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span><span class="op">(</span><span class="va">dose.steps4</span>,<span class="va">pasi.ch</span><span class="op">~</span><span class="va">dose</span>,<span class="va">pasi</span>, test<span class="op">=</span><span class="st">"jonckheere"</span>,alternative<span class="op">=</span><span class="st">"increasing"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pasi.ctp.J1</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : pasi.ch ~ dose , test : jonckheere </span>
<span class="co">## </span>
<span class="co">## Test options:  alternative : increasing    </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=Placebo, 2=ET.10mg, 3=ET.25mg, 4=ET.50mg </span>
<span class="co">## </span>
<span class="co">## Elementary Hypotheses and p-values</span>
<span class="co">## ----------------------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis raw p-value adj. p-value</span>
<span class="co">##        [12]     0.01179      0.05652</span>
<span class="co">##        [23]     0.08284      0.08284</span>
<span class="co">##        [34]     0.21415      0.21415</span></code></pre></div>
</div>
</div>
<div id="proportions" class="section level2">
<h2 class="hasAnchor">
<a href="#proportions" class="anchor"></a>Proportions</h2>
<p>The data set <code>colorectal</code> contains the response rates from a dose finding study in metastatic colorectal cancer. Two doses of the experimental drug were compared to the standard treatment. The response rates in the two dose groups are compared to the control responder rate using both, the <span class="math inline">\(\chi^2\)</span>-test and Fisher’s exact test.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">two.to.first</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/IntersectHypotheses.html">IntersectHypotheses</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/summary.ctp.html">Display</a></span><span class="op">(</span><span class="va">two.to.first</span>,Type<span class="op">=</span><span class="st">"s"</span>,main<span class="op">=</span><span class="st">"two vs control"</span>,arrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#The two elementary hypotheses  are tested after comparing the three proportions globally.</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">colorectal</span><span class="op">)</span>
<span class="va">colorectal.ctp</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span><span class="op">(</span><span class="va">two.to.first</span>,<span class="va">responder</span><span class="op">~</span><span class="va">dose</span>,data<span class="op">=</span><span class="va">colorectal</span>, test<span class="op">=</span><span class="st">"prob"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">colorectal.ctp</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : responder ~ dose , test : prob </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=control, 2=low, 3=high </span>
<span class="co">## </span>
<span class="co">## Elementary Hypotheses and p-values</span>
<span class="co">## ----------------------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis raw p-value adj. p-value</span>
<span class="co">##        [12]     0.02018      0.04459</span>
<span class="co">##        [13]     0.09877      0.09877</span>
<span class="fu"><a href="../reference/summary.ctp.html">Display</a></span><span class="op">(</span><span class="va">colorectal.ctp</span>,Type<span class="op">=</span><span class="st">"t"</span><span class="op">)</span></code></pre></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-7-2.png" width="100%"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">colorectal.chisq</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span><span class="op">(</span><span class="va">two.to.first</span>,<span class="va">responder</span><span class="op">~</span><span class="va">dose</span>,data<span class="op">=</span><span class="va">colorectal</span>, test<span class="op">=</span><span class="st">"chisq"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">colorectal.chisq</span>, digits<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : responder ~ dose , test : chisq </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=control, 2=low, 3=high </span>
<span class="co">## </span>
<span class="co">## Elementary Hypotheses and p-values</span>
<span class="co">## ----------------------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis raw p-value adj. p-value</span>
<span class="co">##        [12]        0.03         0.05</span>
<span class="co">##        [13]        0.11         0.11</span></code></pre></div>
</div>
<div id="survival-analysis-with-the-logrank-test" class="section level2">
<h2 class="hasAnchor">
<a href="#survival-analysis-with-the-logrank-test" class="anchor"></a>Survival Analysis with the logrank test</h2>
<p>This example uses the sample dataset <code>ovarian</code> from the package <code>survival</code>. The overall survival curves of the two treatments <code>rx</code> do not differ significantly:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival">survival</a></span><span class="op">)</span>
       <span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">ovarian</span><span class="op">)</span>
       
       <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html">survdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">futime</span>,<span class="va">fustat</span><span class="op">)</span><span class="op">~</span><span class="va">rx</span>, data<span class="op">=</span><span class="va">ovarian</span><span class="op">)</span><span class="op">)</span>
<span class="co">## Call:</span>
<span class="co">## survdiff(formula = Surv(futime, fustat) ~ rx, data = ovarian)</span>
<span class="co">## </span>
<span class="co">##       N Observed Expected (O-E)^2/E (O-E)^2/V</span>
<span class="co">## rx=1 13        7     5.23     0.596      1.06</span>
<span class="co">## rx=2 13        5     6.77     0.461      1.06</span>
<span class="co">## </span>
<span class="co">##  Chisq= 1.1  on 1 degrees of freedom, p= 0.3</span></code></pre></div>
<p>Together with the performance subgroups <code>ecog=1</code> and <code>ecog=2</code> , a factor “subgroups” defined by the combinations of the performance measure <code>ecog.ps</code> and the treatment <code>rx</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ovarian</span><span class="op">$</span><span class="va">subgroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fl">10</span><span class="op">*</span><span class="va">ovarian</span><span class="op">$</span><span class="va">ecog.ps</span><span class="op">+</span><span class="va">ovarian</span><span class="op">$</span><span class="va">rx</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ovarian</span><span class="op">)</span><span class="op">)</span>
<span class="co">##   futime fustat     age resid.ds rx ecog.ps subgroups</span>
<span class="co">## 1     59      1 72.3315        2  1       1        11</span>
<span class="co">## 2    115      1 74.4932        2  1       1        11</span>
<span class="co">## 3    156      1 66.4658        2  1       2        21</span>
<span class="co">## 4    421      0 53.3644        2  2       1        12</span>
<span class="co">## 5    431      1 50.3397        2  1       1        11</span>
<span class="co">## 6    448      0 56.4301        1  1       2        21</span></code></pre></div>
<p>Then, the treatment differences within the performance subgroups ecog=1 and ecog=2 are compared. I.e. the elementary hypotheses are <em>subgroup11=subgroup12</em> and <em>subgroup21=subgroup22</em> or <span class="math inline">\(\{(1,2),(3,4)\}\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">comb.sub</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IntersectHypotheses.html">IntersectHypotheses</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#Display(comb.sub)</span>
<span class="va">ovar.ctp</span>  <span class="op">&lt;-</span><span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span><span class="op">(</span><span class="va">comb.sub</span>,<span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">futime</span>,<span class="va">fustat</span><span class="op">)</span><span class="op">~</span><span class="va">subgroups</span>, <span class="va">ovarian</span>, test<span class="op">=</span><span class="st">"lgrank"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ovar.ctp</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : Surv(futime, fustat) ~ subgroups , test : lgrank </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=11, 2=12, 3=21, 4=22 </span>
<span class="co">## </span>
<span class="co">## Elementary Hypotheses and p-values</span>
<span class="co">## ----------------------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis raw p-value adj. p-value</span>
<span class="co">##        [12]      0.1119       0.3171</span>
<span class="co">##        [34]      0.8434       0.8434</span>
<span class="fu"><a href="../reference/summary.ctp.html">Display</a></span><span class="op">(</span><span class="va">ovar.ctp</span><span class="op">)</span></code></pre></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-10-1.png" width="100%"></p>
</div>
<div id="comparing-means-when-a-covariate-is-included" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-means-when-a-covariate-is-included" class="anchor"></a>Comparing means when a covariate is included</h2>
<p>In a study with diabetes type II patients (dataset <code>glucose</code>), three doses of a drug are compared to a placebo. The primary variable is the change of fasting plasma glucose from baseline. Fasting plasma glucose at baseline is included into the model as covariate (only implemented for linear and generalised linear models).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">glucose</span><span class="op">)</span>
<span class="va">glucose.ctp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span><span class="op">(</span><span class="va">three.to.first</span>,<span class="va">GLUCOSE.CHANGE</span><span class="op">~</span><span class="va">GLUCOSE.BLA</span><span class="op">+</span><span class="va">DOSE</span>,
                         data<span class="op">=</span><span class="va">glucose</span>, factor.name<span class="op">=</span><span class="st">"DOSE"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">glucose.ctp</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : GLUCOSE.CHANGE ~ GLUCOSE.BLA + DOSE , test : F </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=PLACEBO, 2=LOW, 3=MEDIUM, 4=HIGH </span>
<span class="co">## </span>
<span class="co">## Elementary Hypotheses and p-values</span>
<span class="co">## ----------------------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis raw p-value adj. p-value</span>
<span class="co">##        [12]   6.033e-02    0.0603256</span>
<span class="co">##        [13]   7.086e-05    0.0003536</span>
<span class="co">##        [14]   6.917e-05    0.0003464</span>
<span class="fu"><a href="../reference/summary.ctp.html">Display</a></span><span class="op">(</span><span class="va">glucose.ctp</span>,Type<span class="op">=</span><span class="st">"s"</span><span class="op">)</span></code></pre></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-11-1.png" width="100%"></p>
</div>
<div id="large-hypothesis-trees" class="section level2">
<h2 class="hasAnchor">
<a href="#large-hypothesis-trees" class="anchor"></a>Large hypothesis trees</h2>
<p>Whith an increasing number of hypotheses to test, the graphical display may become quite confusing:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,each<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">)</span>           
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>
<span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">G</span>,<span class="va">y</span><span class="op">)</span>
                
<span class="va">xxx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IntersectHypotheses.html">IntersectHypotheses</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">xxx</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Hypotheses to be tested </span>
<span class="co">## =======================</span>
<span class="co">## </span>
<span class="co">##  hyp.no level hypothesis.name</span>
<span class="co">##       1     1            [12]</span>
<span class="co">##       2     1            [13]</span>
<span class="co">##       3     1            [14]</span>
<span class="co">##       4     1            [15]</span>
<span class="co">##       5     1            [25]</span>
<span class="co">##       6     1            [34]</span>
<span class="co">##       1     2           [123]</span>
<span class="co">##       2     2           [124]</span>
<span class="co">##       3     2           [125]</span>
<span class="co">##       4     2        [12][34]</span>
<span class="co">##       5     2           [134]</span>
<span class="co">##       6     2           [135]</span>
<span class="co">##       7     2        [13][25]</span>
<span class="co">##       8     2           [145]</span>
<span class="co">##       9     2        [14][25]</span>
<span class="co">##      10     2        [15][34]</span>
<span class="co">##      11     2        [25][34]</span>
<span class="co">##       1     3          [1234]</span>
<span class="co">##       2     3          [1235]</span>
<span class="co">##       3     3         [12345]</span>
<span class="co">##       4     3          [1245]</span>
<span class="co">##       5     3       [125][34]</span>
<span class="co">##       6     3          [1345]</span>
<span class="co">##       7     3       [134][25]</span>
<span class="co">##       1     4         [12345]</span>
<span class="co">## </span>
<span class="co">## Connection structure of the hypotheses </span>
<span class="co">## ======================================</span>
<span class="co">## </span>
<span class="co">##  Level            Connection</span>
<span class="co">##      1         [12] -&gt; [123]</span>
<span class="co">##      1         [12] -&gt; [124]</span>
<span class="co">##      1         [12] -&gt; [125]</span>
<span class="co">##      1      [12] -&gt; [12][34]</span>
<span class="co">##      1         [13] -&gt; [123]</span>
<span class="co">##      1         [13] -&gt; [134]</span>
<span class="co">##      1         [13] -&gt; [135]</span>
<span class="co">##      1      [13] -&gt; [13][25]</span>
<span class="co">##      1         [14] -&gt; [124]</span>
<span class="co">##      1         [14] -&gt; [134]</span>
<span class="co">##      1         [14] -&gt; [145]</span>
<span class="co">##      1      [14] -&gt; [14][25]</span>
<span class="co">##      1         [15] -&gt; [125]</span>
<span class="co">##      1         [15] -&gt; [135]</span>
<span class="co">##      1         [15] -&gt; [145]</span>
<span class="co">##      1      [15] -&gt; [15][34]</span>
<span class="co">##      1         [25] -&gt; [125]</span>
<span class="co">##      1      [25] -&gt; [13][25]</span>
<span class="co">##      1      [25] -&gt; [14][25]</span>
<span class="co">##      1      [25] -&gt; [25][34]</span>
<span class="co">##      1      [34] -&gt; [12][34]</span>
<span class="co">##      1         [34] -&gt; [134]</span>
<span class="co">##      1      [34] -&gt; [15][34]</span>
<span class="co">##      1      [34] -&gt; [25][34]</span>
<span class="co">##      2    [12][34] -&gt; [1234]</span>
<span class="co">##      2   [12][34] -&gt; [12345]</span>
<span class="co">##      2 [12][34] -&gt; [125][34]</span>
<span class="co">##      2       [123] -&gt; [1234]</span>
<span class="co">##      2       [123] -&gt; [1235]</span>
<span class="co">##      2      [123] -&gt; [12345]</span>
<span class="co">##      2       [124] -&gt; [1234]</span>
<span class="co">##      2      [124] -&gt; [12345]</span>
<span class="co">##      2       [124] -&gt; [1245]</span>
<span class="co">##      2       [125] -&gt; [1235]</span>
<span class="co">##      2      [125] -&gt; [12345]</span>
<span class="co">##      2       [125] -&gt; [1245]</span>
<span class="co">##      2    [125] -&gt; [125][34]</span>
<span class="co">##      2    [13][25] -&gt; [1235]</span>
<span class="co">##      2   [13][25] -&gt; [12345]</span>
<span class="co">##      2 [13][25] -&gt; [134][25]</span>
<span class="co">##      2       [134] -&gt; [1234]</span>
<span class="co">##      2      [134] -&gt; [12345]</span>
<span class="co">##      2       [134] -&gt; [1345]</span>
<span class="co">##      2    [134] -&gt; [134][25]</span>
<span class="co">##      2       [135] -&gt; [1235]</span>
<span class="co">##      2      [135] -&gt; [12345]</span>
<span class="co">##      2       [135] -&gt; [1345]</span>
<span class="co">##      2   [14][25] -&gt; [12345]</span>
<span class="co">##      2    [14][25] -&gt; [1245]</span>
<span class="co">##      2 [14][25] -&gt; [134][25]</span>
<span class="co">##      2      [145] -&gt; [12345]</span>
<span class="co">##      2       [145] -&gt; [1245]</span>
<span class="co">##      2       [145] -&gt; [1345]</span>
<span class="co">##      2   [15][34] -&gt; [12345]</span>
<span class="co">##      2 [15][34] -&gt; [125][34]</span>
<span class="co">##      2    [15][34] -&gt; [1345]</span>
<span class="co">##      2   [25][34] -&gt; [12345]</span>
<span class="co">##      2 [25][34] -&gt; [125][34]</span>
<span class="co">##      2 [25][34] -&gt; [134][25]</span>
<span class="co">##      3     [1234] -&gt; [12345]</span>
<span class="co">##      3    [12345] -&gt; [12345]</span>
<span class="co">##      3     [1235] -&gt; [12345]</span>
<span class="co">##      3     [1245] -&gt; [12345]</span>
<span class="co">##      3  [125][34] -&gt; [12345]</span>
<span class="co">##      3  [134][25] -&gt; [12345]</span>
<span class="co">##      3     [1345] -&gt; [12345]</span>
<span class="fu"><a href="../reference/summary.ctp.html">Display</a></span><span class="op">(</span><span class="va">xxx</span><span class="op">)</span></code></pre></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-12-1.png" width="100%"></p>
</div>
<div id="external-p-values" class="section level2">
<h2 class="hasAnchor">
<a href="#external-p-values" class="anchor"></a>“External” p-values</h2>
<p>It is possible to:</p>
<ul>
<li>Use <code>IntersectHypotheses</code> to create the closure set and <code>Display</code> to plot the corresponding hypothesis tree.</li>
<li>Calculate the p-values for the local hypotheses with other functions or software.</li>
<li>Import these p-values.</li>
<li>Use <code>Adjust_raw</code> to calculte the adjusted p-values for the elementary hypotheses. <code>Adjust_raw</code> delivers an object of class <code>ctp</code>.</li>
<li>Use <code>summary</code> and <code>Display</code> on this object.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">        <span class="va">Pairwise</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IntersectHypotheses.html">IntersectHypotheses</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
        <span class="fu"><a href="../reference/summary.ctp.html">Display</a></span><span class="op">(</span><span class="va">Pairwise</span><span class="op">)</span></code></pre></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-13-1.png" width="100%"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R">        <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Pairwise</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Hypotheses to be tested </span>
<span class="co">## =======================</span>
<span class="co">## </span>
<span class="co">##  hyp.no level hypothesis.name</span>
<span class="co">##       1     1            [12]</span>
<span class="co">##       2     1            [13]</span>
<span class="co">##       3     1            [14]</span>
<span class="co">##       4     1            [23]</span>
<span class="co">##       5     1            [24]</span>
<span class="co">##       6     1            [34]</span>
<span class="co">##       1     2           [123]</span>
<span class="co">##       2     2           [124]</span>
<span class="co">##       3     2        [12][34]</span>
<span class="co">##       4     2           [134]</span>
<span class="co">##       5     2        [13][24]</span>
<span class="co">##       6     2        [14][23]</span>
<span class="co">##       7     2           [234]</span>
<span class="co">##       1     3          [1234]</span>
<span class="co">## </span>
<span class="co">## Connection structure of the hypotheses </span>
<span class="co">## ======================================</span>
<span class="co">## </span>
<span class="co">##  Level         Connection</span>
<span class="co">##      1      [12] -&gt; [123]</span>
<span class="co">##      1      [12] -&gt; [124]</span>
<span class="co">##      1   [12] -&gt; [12][34]</span>
<span class="co">##      1      [13] -&gt; [123]</span>
<span class="co">##      1      [13] -&gt; [134]</span>
<span class="co">##      1   [13] -&gt; [13][24]</span>
<span class="co">##      1      [14] -&gt; [124]</span>
<span class="co">##      1      [14] -&gt; [134]</span>
<span class="co">##      1   [14] -&gt; [14][23]</span>
<span class="co">##      1      [23] -&gt; [123]</span>
<span class="co">##      1   [23] -&gt; [14][23]</span>
<span class="co">##      1      [23] -&gt; [234]</span>
<span class="co">##      1      [24] -&gt; [124]</span>
<span class="co">##      1   [24] -&gt; [13][24]</span>
<span class="co">##      1      [24] -&gt; [234]</span>
<span class="co">##      1   [34] -&gt; [12][34]</span>
<span class="co">##      1      [34] -&gt; [134]</span>
<span class="co">##      1      [34] -&gt; [234]</span>
<span class="co">##      2 [12][34] -&gt; [1234]</span>
<span class="co">##      2    [123] -&gt; [1234]</span>
<span class="co">##      2    [124] -&gt; [1234]</span>
<span class="co">##      2 [13][24] -&gt; [1234]</span>
<span class="co">##      2    [134] -&gt; [1234]</span>
<span class="co">##      2 [14][23] -&gt; [1234]</span>
<span class="co">##      2    [234] -&gt; [1234]</span>
        
        <span class="co"># the vector of p-values calculated by another software</span>
        <span class="co"># (Example from Prof. John M. Lachin, The Biostatistics Center Rockville MD)</span>
        
        <span class="va">p.val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
          <span class="fl">0.4374</span>,
          <span class="fl">0.6485</span>,
          <span class="fl">0.4103</span>,
          <span class="fl">0.2203</span>,
          <span class="fl">0.1302</span>,
          <span class="fl">0.6725</span>,
          <span class="fl">0.4704</span>,
          <span class="fl">0.3173</span>,
          <span class="fl">0.6762</span>,
          <span class="fl">0.7112</span>,
          <span class="fl">0.2866</span>,
          <span class="fl">0.3362</span>,
          <span class="fl">0.2871</span>,
          <span class="fl">0.4633</span><span class="op">)</span>

        <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Adjust_raw.html">Adjust_raw</a></span><span class="op">(</span><span class="va">Pairwise</span>, p.value<span class="op">=</span><span class="va">p.val</span><span class="op">)</span>
        
        <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">result</span>,digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>    
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Elementary Hypotheses and p-values</span>
<span class="co">## ----------------------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis raw p-value adj. p-value</span>
<span class="co">##        [12]       0.437        0.676</span>
<span class="co">##        [13]       0.648        0.711</span>
<span class="co">##        [14]       0.410        0.711</span>
<span class="co">##        [23]       0.220        0.470</span>
<span class="co">##        [24]       0.130        0.463</span>
<span class="co">##        [34]       0.672        0.711</span>
                
<span class="co"># details may be documented</span>
        
        <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Adjust_raw.html">Adjust_raw</a></span><span class="op">(</span><span class="va">Pairwise</span>, p.value<span class="op">=</span><span class="va">p.val</span>
                             ,dataset.name<span class="op">=</span><span class="st">"my Data"</span>, factor.name<span class="op">=</span><span class="st">"Factor"</span>
                             ,factor.levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span><span class="op">)</span>, model<span class="op">=</span><span class="va">y</span><span class="op">~</span><span class="va">Factor</span>
                             ,test.name<span class="op">=</span><span class="st">"my Test"</span><span class="op">)</span>
        
        <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">result</span>,digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : y ~ Factor , test : my Test </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=A, 2=B, 3=C, 4=D </span>
<span class="co">## </span>
<span class="co">## Elementary Hypotheses and p-values</span>
<span class="co">## ----------------------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis raw p-value adj. p-value</span>
<span class="co">##        [12]       0.437        0.676</span>
<span class="co">##        [13]       0.648        0.711</span>
<span class="co">##        [14]       0.410        0.711</span>
<span class="co">##        [23]       0.220        0.470</span>
<span class="co">##        [24]       0.130        0.463</span>
<span class="co">##        [34]       0.672        0.711</span></code></pre></div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bauer1991" class="csl-entry">
Bauer, Peter. 1991. <span>“Multiple Testing in Clinical Trials.”</span> <em>Statistics in Medicine</em> 10 (4): 261–63.
</div>
<div id="ref-Bretz2011" class="csl-entry">
Bretz, Frank, Hothorn, T., and Westfall, P. 2011. <em>Multiple Comparisons Using R</em>. CRC Press.
</div>
<div id="ref-Dmit2010" class="csl-entry">
Dmitrienko, Alex, Tamhane, A., and Bretz, F. 2010. <em>Multiple Testing Problems in Pharmaceutical Statistics</em>. Chapman &amp; Hall.
</div>
<div id="ref-Gabriel1976" class="csl-entry">
Marcus, Ruth, Peritz, E., and Gabriel, K.R. 1976. <span>“On Closed Testing Procedures with Special Reference to Ordered Analysis of Variance.”</span> <em>Biometrika</em> 63: 655–60.
</div>
<div id="ref-emmeans" class="csl-entry">
Russell, and Lenth. 2020. <span>“Estimated Marginal Means, Aka Least-Squares Means.”</span>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Paul Jordan, Matthias Herpers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
