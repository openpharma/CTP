<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Closed Testing Procedure • CTP</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Closed Testing Procedure">
<meta property="og:description" content="CTP">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CTP</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Flowchart.html">Flowchart how to use CTP</a>
    </li>
    <li>
      <a href="../articles/closed_testing_procedure.html">Closed Testing Procedure</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="closed_testing_procedure_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Closed Testing Procedure</h1>
                        <h4 class="author">Paul Jordan</h4>
            
            <h4 class="date">2020-10-19</h4>
      
      
      <div class="hidden name"><code>closed_testing_procedure.Rmd</code></div>

    </div>

    
    
<div id="the-closure-principle" class="section level1">
<h1 class="hasAnchor">
<a href="#the-closure-principle" class="anchor"></a>The Closure Principle</h1>
<p>The closure principle is a way to protect the type-I error from muliple testing. Here, we follow the the description in <span class="citation">(Bretz, Hothorn, T., and Westfall,P. 2011)</span>. It consists of four steps:</p>
<ol style="list-style-type: decimal">
<li><p>Definition of a set <span class="math inline">\({H} = \{H_1,\ldots, H_n\}\)</span> of elementary hypotheses.</p></li>
<li><p>Construction of the closure set (“Hypothesis Tree”).</p></li>
</ol>
<p><span class="math display">\[\overline{H} = \left \{ H_I =\bigcap_{i \in I}H_i :  \quad I \subseteq \{1,\ldots,n\} \right \} \]</span> (all intersection hypotheses <span class="math inline">\(H_I\)</span>).</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Construction of a local level-<span class="math inline">\(\alpha\)</span> test for each <span class="math inline">\(H_I \in \overline{H}\)</span>.</p></li>
<li><p>Rejection of <span class="math inline">\(H_i\)</span>, if <em>all</em> null hypotheses <span class="math inline">\(H_I \in \overline{H}\)</span> with <span class="math inline">\(i \in I\)</span> are rejected at at the local level <span class="math inline">\(\alpha\)</span>.</p></li>
</ol>
<div id="adjusted-p-values" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusted-p-values" class="anchor"></a>Adjusted p-values</h2>
<p>As the null hypothesis <span class="math inline">\(H_i\)</span> is rejected only if the null hypothteses <span class="math inline">\(H_I \in \overline{H}\)</span> with <span class="math inline">\(i \in I\)</span> are rejected (see point 4. above), the adjusted p-value <span class="math inline">\(p_{adj;i}\)</span> for <span class="math inline">\(H_i\)</span> is defined as:</p>
<ol style="list-style-type: decimal">
<li>Denote with <span class="math inline">\(p_I\)</span> the p-value for a given intersection hypothesis <span class="math inline">\(H_I, \quad I \subseteq \{1, \ldots,n\}\)</span>.</li>
<li>Then, <span class="math inline">\(p_{adj;i}=\max_\limits{I:i\in I} p_I,\quad i=1,\ldots , n\)</span>.</li>
</ol>
</div>
</div>
<div id="implementation" class="section level1">
<h1 class="hasAnchor">
<a href="#implementation" class="anchor"></a>Implementation</h1>
<div id="closure-set" class="section level2">
<h2 class="hasAnchor">
<a href="#closure-set" class="anchor"></a>Closure set</h2>
<p>The hypothesis tree of the closed testing procedure is created using the function <strong>IntersectHypotheses</strong>.</p>
</div>
<div id="local-tests-ctp-for-a-given-hypothesis-tree" class="section level2">
<h2 class="hasAnchor">
<a href="#local-tests-ctp-for-a-given-hypothesis-tree" class="anchor"></a>Local tests CTP for a given “hypothesis tree”</h2>
<p>In case of single hypotheses (ie. if the hypothesis can be described by a single integer vector eg. <strong>(1,3,5)</strong> the test (F-Test, Kruskal-Wallis-test, probability test, logrank test, ….) is applied directly.</p>
<p>For combined hypotheses (i.e. for hypotheses described by several non-overlapping integer vectors eg. <strong>(1,2), (3,4)</strong>, The procedure differs for the F-test and other tests.</p>
<p>In case of the F-test the contrast matrices for the single hypotheses included are combined and these contrasts are tested simultaneously. For all other tests first the p-values <span class="math inline">\(p_1, p_2, \ldots ,p_m\)</span> for the single hypotheses are calculated, and than these are combined by Fisher’s combination rule:</p>
<p>If all m hypotheses are assumed to be independent, the test statistics <span class="math inline">\(X\)</span> follows under <span class="math inline">\(H_0\)</span> a <span class="math inline">\(\chi^2\)</span>-distribution with 2m degrees of freedom: <span class="math display">\[ X=-2\sum_{i=1}^{m}\ln(p_i) \sim \chi_{2m}^2\]</span> from which a p-value for the global hypothesis can be easily obtained.</p>
<p>In case of trend tests, the same type of test is applied for all intermediate single tests.</p>
</div>
<div id="adjusted-p-values-1" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusted-p-values-1" class="anchor"></a>Adjusted p-values</h2>
<p>Finally the p-values are adjusted by calculating the maximum of the p-values of all tests used at a certain stage of the CTP to decide on the hypothesis in question.</p>
<p>The function <strong>AnalyseCTP</strong> calculates all local and adjusted p-value for all hypotheses in the closure set (hypothesis tree).</p>
<p>With the function <strong>Adjust_raw</strong>, it is also possible to use p-values that have been calculated by other functions or programs for the calculation of the adjusted p-values.</p>
</div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<div id="comparing-means" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-means" class="anchor"></a>Comparing means</h2>
<p>The dataframe <strong>pasi</strong> comprises the changes in PASI-score (Psoirasis Area and Severity Index) from baseline within two month of 72 patients treated with three different doses of Etretin or Placebo in a double blind study.</p>
<p>Testing the elementary hypotheses 1:2, 1:3, 1:4 simultaneously using the F-Test i.e. testing <span class="math inline">\(H_1: \mu_1=\mu_2\)</span>, <span class="math inline">\(H_2: \mu_1=\mu_3\)</span> and <span class="math inline">\(H_3: \mu_1=\mu_4\)</span> simultaneously. The groups with levels 2,3,4 are compared to the control (Placebo) group (level 1). In this specific example, the adjusted and unadjusted p-values are the same. All doses show a significant effect compared to Placebo</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">CTP</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">pasi</span>)
<span class="no">three.to.first</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/IntersectHypotheses.html">IntersectHypotheses</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fl">1</span>:<span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>),<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">4</span>)))
<span class="fu"><a href="../reference/Generic_functions.html">Display</a></span>(<span class="no">three.to.first</span>,<span class="kw">Type</span><span class="kw">=</span><span class="st">"s"</span>,<span class="kw">arrow</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-1-1.png" width="100%"></p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">pasi.ctp.F1</span>    <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span>(<span class="no">three.to.first</span>,<span class="no">pasi.ch</span>~<span class="no">dose</span>,<span class="no">pasi</span>)
<span class="no">xsx</span>            <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">three.to.first</span>)
<span class="co">## New names:</span>
<span class="co">## * hyp.no -&gt; hyp.no...2</span>
<span class="co">## * hyp.no -&gt; hyp.no...5</span>
<span class="co">## </span>
<span class="co">## Hypotheses to be tested </span>
<span class="co">## =======================</span>
<span class="co">## </span>
<span class="co">##  hyp.no level hypothesis.name</span>
<span class="co">##       1     1            [12]</span>
<span class="co">##       2     1            [13]</span>
<span class="co">##       3     1            [14]</span>
<span class="co">##       1     2           [123]</span>
<span class="co">##       2     2           [124]</span>
<span class="co">##       3     2           [134]</span>
<span class="co">##       1     3          [1234]</span>
<span class="co">## </span>
<span class="co">## Connection structure of the hypotheses </span>
<span class="co">## ======================================</span>
<span class="co">## </span>
<span class="co">##  Level      Connection</span>
<span class="co">##      1   [12] -&gt; [123]</span>
<span class="co">##      1   [12] -&gt; [124]</span>
<span class="co">##      1   [13] -&gt; [123]</span>
<span class="co">##      1   [13] -&gt; [134]</span>
<span class="co">##      1   [14] -&gt; [124]</span>
<span class="co">##      1   [14] -&gt; [134]</span>
<span class="co">##      2 [123] -&gt; [1234]</span>
<span class="co">##      2 [124] -&gt; [1234]</span>
<span class="co">##      2 [134] -&gt; [1234]</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">pasi.ctp.F1</span>)
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : pasi.ch ~ dose , test : F </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=Placebo, 2=ET.10mg, 3=ET.25mg, 4=ET.50mg </span>
<span class="co">## </span>
<span class="co">## Hypotheses and p-values</span>
<span class="co">## -----------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis Level raw p-value adj. p-value</span>
<span class="co">##        [12]     1   4.748e-03    4.748e-03</span>
<span class="co">##        [13]     1   2.737e-05    1.063e-04</span>
<span class="co">##        [14]     1   1.826e-06    9.797e-06</span>
<span class="co">##       [123]     2   1.063e-04    1.063e-04</span>
<span class="co">##       [124]     2   9.797e-06    9.797e-06</span>
<span class="co">##       [134]     2   1.736e-06    6.542e-06</span>
<span class="co">##      [1234]     3   6.542e-06    6.542e-06</span>
<span class="fu"><a href="../reference/Generic_functions.html">Display</a></span>(<span class="no">pasi.ctp.F1</span>)</pre></body></html></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-1-2.png" width="100%"></p>
<div class="sourceCode" id="cb3"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">pasi</span>)
<span class="no">three.to.first</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/IntersectHypotheses.html">IntersectHypotheses</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fl">1</span>:<span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>),<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">4</span>)))
<span class="fu"><a href="../reference/Generic_functions.html">Display</a></span>(<span class="no">three.to.first</span>,<span class="kw">Type</span><span class="kw">=</span><span class="st">"s"</span>,<span class="kw">arrow</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-2-1.png" width="100%"></p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">pasi.ctp.F1</span>    <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span>(<span class="no">three.to.first</span>,<span class="no">pasi.ch</span>~<span class="no">dose</span>,<span class="no">pasi</span>)
<span class="no">xsx</span>            <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">three.to.first</span>)
<span class="co">## New names:</span>
<span class="co">## * hyp.no -&gt; hyp.no...2</span>
<span class="co">## * hyp.no -&gt; hyp.no...5</span>
<span class="co">## </span>
<span class="co">## Hypotheses to be tested </span>
<span class="co">## =======================</span>
<span class="co">## </span>
<span class="co">##  hyp.no level hypothesis.name</span>
<span class="co">##       1     1            [12]</span>
<span class="co">##       2     1            [13]</span>
<span class="co">##       3     1            [14]</span>
<span class="co">##       1     2           [123]</span>
<span class="co">##       2     2           [124]</span>
<span class="co">##       3     2           [134]</span>
<span class="co">##       1     3          [1234]</span>
<span class="co">## </span>
<span class="co">## Connection structure of the hypotheses </span>
<span class="co">## ======================================</span>
<span class="co">## </span>
<span class="co">##  Level      Connection</span>
<span class="co">##      1   [12] -&gt; [123]</span>
<span class="co">##      1   [12] -&gt; [124]</span>
<span class="co">##      1   [13] -&gt; [123]</span>
<span class="co">##      1   [13] -&gt; [134]</span>
<span class="co">##      1   [14] -&gt; [124]</span>
<span class="co">##      1   [14] -&gt; [134]</span>
<span class="co">##      2 [123] -&gt; [1234]</span>
<span class="co">##      2 [124] -&gt; [1234]</span>
<span class="co">##      2 [134] -&gt; [1234]</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">pasi.ctp.F1</span>)
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : pasi.ch ~ dose , test : F </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=Placebo, 2=ET.10mg, 3=ET.25mg, 4=ET.50mg </span>
<span class="co">## </span>
<span class="co">## Hypotheses and p-values</span>
<span class="co">## -----------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis Level raw p-value adj. p-value</span>
<span class="co">##        [12]     1   4.748e-03    4.748e-03</span>
<span class="co">##        [13]     1   2.737e-05    1.063e-04</span>
<span class="co">##        [14]     1   1.826e-06    9.797e-06</span>
<span class="co">##       [123]     2   1.063e-04    1.063e-04</span>
<span class="co">##       [124]     2   9.797e-06    9.797e-06</span>
<span class="co">##       [134]     2   1.736e-06    6.542e-06</span>
<span class="co">##      [1234]     3   6.542e-06    6.542e-06</span>
<span class="fu"><a href="../reference/Generic_functions.html">Display</a></span>(<span class="no">pasi.ctp.F1</span>)</pre></body></html></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-2-2.png" width="100%"></p>
</div>
<div id="another-hypothesis-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#another-hypothesis-structure" class="anchor"></a>Another hypothesis structure</h2>
<p>Testing the elementary hypotheses 1:2, 2:3, 3:4 simultaneously using the F-Test, i.e. testing <span class="math inline">\(H_1: \mu_1=\mu_2\)</span>, <span class="math inline">\(H_2: \mu_2=\mu_3\)</span> and <span class="math inline">\(H_3: \mu_3=\mu_4\)</span> simultaneously. This provides quite different results (compared to pasi.ctp.F1): No further improvement for higher doses.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">dose.steps4</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/IntersectHypotheses.html">IntersectHypotheses</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fl">1</span>:<span class="fl">2</span>,<span class="fl">2</span>:<span class="fl">3</span>,<span class="fl">3</span>:<span class="fl">4</span>))
<span class="fu"><a href="../reference/Generic_functions.html">Display</a></span>(<span class="no">dose.steps4</span>,<span class="kw">arr</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">


<span class="no">pasi.ctp.F2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span>(<span class="no">dose.steps4</span>,<span class="no">pasi.ch</span>~<span class="no">dose</span>,<span class="no">pasi</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">pasi.ctp.F2</span>)
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : pasi.ch ~ dose , test : F </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=Placebo, 2=ET.10mg, 3=ET.25mg, 4=ET.50mg </span>
<span class="co">## </span>
<span class="co">## Hypotheses and p-values</span>
<span class="co">## -----------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis Level raw p-value adj. p-value</span>
<span class="co">##        [12]     1   4.748e-03    1.506e-02</span>
<span class="co">##        [23]     1   1.139e-01    1.139e-01</span>
<span class="co">##        [34]     1   5.257e-01    5.257e-01</span>
<span class="co">##       [123]     2   1.063e-04    1.063e-04</span>
<span class="co">##    [12][34]     2   1.506e-02    1.506e-02</span>
<span class="co">##       [234]     2   7.205e-02    7.205e-02</span>
<span class="co">##      [1234]     3   6.542e-06    6.542e-06</span>
<span class="fu"><a href="../reference/Generic_functions.html">Display</a></span>(<span class="no">pasi.ctp.F2</span>)</pre></body></html></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-3-2.png" width="100%"></p>
</div>
<div id="other-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#other-tests" class="anchor"></a>Other tests</h2>
<p>For the same hypotheis structure, other tests can also be used:</p>
<div id="kruskal-wallis-test-of-trend-for-all-single-hypotheses" class="section level3">
<h3 class="hasAnchor">
<a href="#kruskal-wallis-test-of-trend-for-all-single-hypotheses" class="anchor"></a>Kruskal-Wallis test of trend for all single hypotheses</h3>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">pasi.ctp.K</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span>(<span class="no">dose.steps4</span>,<span class="no">pasi.ch</span>~<span class="no">dose</span>,<span class="no">pasi</span>, <span class="kw">test</span><span class="kw">=</span><span class="st">"kruskal"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">pasi.ctp.K</span>)
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : pasi.ch ~ dose , test : kruskal </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=Placebo, 2=ET.10mg, 3=ET.25mg, 4=ET.50mg </span>
<span class="co">## </span>
<span class="co">## Hypotheses and p-values</span>
<span class="co">## -----------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis Level raw p-value adj. p-value</span>
<span class="co">##        [12]     1   2.350e-02    5.605e-02</span>
<span class="co">##        [23]     1   1.655e-01    1.655e-01</span>
<span class="co">##        [34]     1   4.255e-01    4.255e-01</span>
<span class="co">##       [123]     2   1.466e-03    1.466e-03</span>
<span class="co">##    [12][34]     2   5.605e-02    5.605e-02</span>
<span class="co">##       [234]     2   6.988e-02    6.988e-02</span>
<span class="co">##      [1234]     3   7.557e-05    7.557e-05</span>
<span class="fu"><a href="../reference/Generic_functions.html">Display</a></span>(<span class="no">pasi.ctp.K</span>)</pre></body></html></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
</div>
<div id="jonckheere-terpstra-test-of-trend-for-all-single-hypotheses" class="section level3">
<h3 class="hasAnchor">
<a href="#jonckheere-terpstra-test-of-trend-for-all-single-hypotheses" class="anchor"></a>Jonckheere-Terpstra test of trend for all single hypotheses</h3>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">pasi.ctp.J1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span>(<span class="no">dose.steps4</span>,<span class="no">pasi.ch</span>~<span class="no">dose</span>,<span class="no">pasi</span>, <span class="kw">test</span><span class="kw">=</span><span class="st">"jonckheere"</span>,<span class="kw">alternative</span><span class="kw">=</span><span class="st">"increasing"</span>)
<span class="no">pasi.ctp.J2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span>(<span class="no">dose.steps4</span>,<span class="no">pasi.ch</span>~<span class="no">dose</span>,<span class="no">pasi</span>, <span class="kw">test</span><span class="kw">=</span><span class="st">"jonckheere"</span>,<span class="kw">alternative</span><span class="kw">=</span><span class="st">"two.sided"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">pasi.ctp.J1</span>)
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : pasi.ch ~ dose , test : jonckheere </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=Placebo, 2=ET.10mg, 3=ET.25mg, 4=ET.50mg </span>
<span class="co">## </span>
<span class="co">## Hypotheses and p-values</span>
<span class="co">## -----------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis Level raw p-value adj. p-value</span>
<span class="co">##        [12]     1   1.179e-02    5.652e-02</span>
<span class="co">##        [23]     1   8.284e-02    8.284e-02</span>
<span class="co">##        [34]     1   2.141e-01    2.141e-01</span>
<span class="co">##       [123]     2   1.563e-04    1.563e-04</span>
<span class="co">##    [12][34]     2   5.652e-02    5.652e-02</span>
<span class="co">##       [234]     2   1.189e-02    1.189e-02</span>
<span class="co">##      [1234]     3   1.890e-06    1.890e-06</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">pasi.ctp.J2</span>)
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : pasi.ch ~ dose , test : jonckheere </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=Placebo, 2=ET.10mg, 3=ET.25mg, 4=ET.50mg </span>
<span class="co">## </span>
<span class="co">## Hypotheses and p-values</span>
<span class="co">## -----------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis Level raw p-value adj. p-value</span>
<span class="co">##        [12]     1   2.359e-02    5.652e-02</span>
<span class="co">##        [23]     1   1.657e-01    1.657e-01</span>
<span class="co">##        [34]     1   4.283e-01    4.283e-01</span>
<span class="co">##       [123]     2   3.127e-04    3.127e-04</span>
<span class="co">##    [12][34]     2   5.652e-02    5.652e-02</span>
<span class="co">##       [234]     2   2.377e-02    2.377e-02</span>
<span class="co">##      [1234]     3   3.781e-06    3.781e-06</span>
<span class="no">pasi.ctp.J3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span>(<span class="no">dose.steps4</span>,<span class="no">pasi.ch</span>~<span class="no">dose</span>,<span class="no">pasi</span>, <span class="kw">test</span><span class="kw">=</span><span class="st">"jonckheere"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">pasi.ctp.J3</span>)
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : pasi.ch ~ dose , test : jonckheere </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=Placebo, 2=ET.10mg, 3=ET.25mg, 4=ET.50mg </span>
<span class="co">## </span>
<span class="co">## Hypotheses and p-values</span>
<span class="co">## -----------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis Level raw p-value adj. p-value</span>
<span class="co">##        [12]     1   2.359e-02    5.652e-02</span>
<span class="co">##        [23]     1   1.657e-01    1.657e-01</span>
<span class="co">##        [34]     1   4.283e-01    4.283e-01</span>
<span class="co">##       [123]     2   3.127e-04    3.127e-04</span>
<span class="co">##    [12][34]     2   5.652e-02    5.652e-02</span>
<span class="co">##       [234]     2   2.377e-02    2.377e-02</span>
<span class="co">##      [1234]     3   3.781e-06    3.781e-06</span>
<span class="fu"><a href="../reference/Generic_functions.html">Display</a></span>(<span class="no">pasi.ctp.J1</span>)</pre></body></html></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
</div>
</div>
<div id="proportions" class="section level2">
<h2 class="hasAnchor">
<a href="#proportions" class="anchor"></a>Proportions</h2>
<p>The data set <strong>colorectal</strong> contains the response rates from a dose finding study in metastatic colorectal cancer. Two doses of the experimental drug were compared to the standard treatment. The response rates in the two dose groups are compared to the control responder rate using both, the <span class="math inline">\(\chi^2\)</span>-test and Fisher’s exact test.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">two.to.first</span><span class="kw">&lt;-</span> <span class="fu"><a href="../reference/IntersectHypotheses.html">IntersectHypotheses</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fl">1</span>:<span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>)))

<span class="fu"><a href="../reference/Generic_functions.html">Display</a></span>(<span class="no">two.to.first</span>,<span class="kw">Type</span><span class="kw">=</span><span class="st">"s"</span>,<span class="kw">main</span><span class="kw">=</span><span class="st">"two vs control"</span>,<span class="kw">arrow</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-6-1.png" width="100%"></p>
<div class="sourceCode" id="cb10"><html><body><pre class="r">
<span class="co">#The two elementary hypotheses  are tested after comparing the three proportions globally.</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">colorectal</span>)
<span class="no">colorectal.ctp</span> <span class="kw">&lt;-</span><span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span>(<span class="no">two.to.first</span>,<span class="no">responder</span>~<span class="no">dose</span>,<span class="kw">data</span><span class="kw">=</span><span class="no">colorectal</span>, <span class="kw">test</span><span class="kw">=</span><span class="st">"prob"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">colorectal.ctp</span>)
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : responder ~ dose , test : prob </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=control, 2=low, 3=high </span>
<span class="co">## </span>
<span class="co">## Hypotheses and p-values</span>
<span class="co">## -----------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis Level raw p-value adj. p-value</span>
<span class="co">##        [12]     1     0.02018      0.04459</span>
<span class="co">##        [13]     1     0.09877      0.09877</span>
<span class="co">##       [123]     2     0.04459      0.04459</span>
<span class="fu"><a href="../reference/Generic_functions.html">Display</a></span>(<span class="no">colorectal.ctp</span>,<span class="kw">Type</span><span class="kw">=</span><span class="st">"t"</span>)</pre></body></html></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-6-2.png" width="100%"></p>
<div class="sourceCode" id="cb11"><html><body><pre class="r">
<span class="no">colorectal.chisq</span> <span class="kw">&lt;-</span><span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span>(<span class="no">two.to.first</span>,<span class="no">responder</span>~<span class="no">dose</span>,<span class="kw">data</span><span class="kw">=</span><span class="no">colorectal</span>, <span class="kw">test</span><span class="kw">=</span><span class="st">"chisq"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">colorectal.chisq</span>, <span class="kw">digits</span><span class="kw">=</span><span class="fl">1</span>)
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : responder ~ dose , test : chisq </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=control, 2=low, 3=high </span>
<span class="co">## </span>
<span class="co">## Hypotheses and p-values</span>
<span class="co">## -----------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis Level raw p-value adj. p-value</span>
<span class="co">##        [12]     1        0.03         0.05</span>
<span class="co">##        [13]     1        0.11         0.11</span>
<span class="co">##       [123]     2        0.05         0.05</span></pre></body></html></div>
</div>
<div id="survival-analysis-with-the-logrank-test" class="section level2">
<h2 class="hasAnchor">
<a href="#survival-analysis-with-the-logrank-test" class="anchor"></a>Survival Analysis with the logrank test</h2>
<p>This example uses the sample dataset <strong>ovarian</strong> from the package <strong>survival</strong>. The overall survival curves of the two treatments <em>rx</em> do not differ significantly:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">survival</span>)
       <span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">ovarian</span>)

       <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html">survdiff</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span>(<span class="no">futime</span>,<span class="no">fustat</span>)~<span class="no">rx</span>, <span class="kw">data</span><span class="kw">=</span><span class="no">ovarian</span>))
<span class="co">## Call:</span>
<span class="co">## survdiff(formula = Surv(futime, fustat) ~ rx, data = ovarian)</span>
<span class="co">## </span>
<span class="co">##       N Observed Expected (O-E)^2/E (O-E)^2/V</span>
<span class="co">## rx=1 13        7     5.23     0.596      1.06</span>
<span class="co">## rx=2 13        5     6.77     0.461      1.06</span>
<span class="co">## </span>
<span class="co">##  Chisq= 1.1  on 1 degrees of freedom, p= 0.3</span></pre></body></html></div>
<p>Together with the performance subgroups <em>ecog=1</em> and <em>ecog=2</em> , a factor “subgroups” defined by the combinations of the performance measure <em>ecog.ps</em> and the treatment <em>rx</em>.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">ovarian</span>$<span class="no">subgroups</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="fl">10</span>*<span class="no">ovarian</span>$<span class="no">ecog.ps</span>+<span class="no">ovarian</span>$<span class="no">rx</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">ovarian</span>))
<span class="co">##   futime fustat     age resid.ds rx ecog.ps subgroups</span>
<span class="co">## 1     59      1 72.3315        2  1       1        11</span>
<span class="co">## 2    115      1 74.4932        2  1       1        11</span>
<span class="co">## 3    156      1 66.4658        2  1       2        21</span>
<span class="co">## 4    421      0 53.3644        2  2       1        12</span>
<span class="co">## 5    431      1 50.3397        2  1       1        11</span>
<span class="co">## 6    448      0 56.4301        1  1       2        21</span></pre></body></html></div>
<p>Then, the treatment differences within the performance subgroups ecog=1 and ecog=2 are compared. I.e. the elementary hypotheses are <em>subgroup11=subgroup12</em> and <em>subgroup21=subgroup22</em> or <span class="math inline">\(\{(1,2),(3,4)\}\)</span>.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">comb.sub</span>  <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/IntersectHypotheses.html">IntersectHypotheses</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>),<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">4</span>)))
<span class="co">#Display(comb.sub)</span>
<span class="no">ovar.ctp</span>  <span class="kw">&lt;-</span><span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span>(<span class="no">comb.sub</span>,<span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span>(<span class="no">futime</span>,<span class="no">fustat</span>)~<span class="no">subgroups</span>, <span class="no">ovarian</span>, <span class="kw">test</span><span class="kw">=</span><span class="st">"lgrank"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">ovar.ctp</span>)
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : Surv(futime, fustat) ~ subgroups , test : lgrank </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=11, 2=12, 3=21, 4=22 </span>
<span class="co">## </span>
<span class="co">## Hypotheses and p-values</span>
<span class="co">## -----------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis Level raw p-value adj. p-value</span>
<span class="co">##        [12]     1      0.1119       0.3171</span>
<span class="co">##        [34]     1      0.8434       0.8434</span>
<span class="co">##    [12][34]     2      0.3171       0.3171</span>
<span class="fu"><a href="../reference/Generic_functions.html">Display</a></span>(<span class="no">ovar.ctp</span>)</pre></body></html></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-9-1.png" width="100%"></p>
</div>
<div id="comparing-means-when-a-covariate-is-included" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-means-when-a-covariate-is-included" class="anchor"></a>Comparing means when a covariate is included</h2>
<p>In a study with diabetes type II patients (dataset <strong>glucose</strong>), three doses of a drug are compared to a placebo. The primary variable is the change of fasting plasma glucose from baseline. Fasting plasma glucose at baseline is included into the model as covariate (only implmented for linear models).</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">glucose</span>)
<span class="no">glucose.ctp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/AnalyseCTP.html">AnalyseCTP</a></span>(<span class="no">three.to.first</span>,<span class="no">GLUCOSE.CHANGE</span>~<span class="no">GLUCOSE.BLA</span>+<span class="no">DOSE</span>,
                         <span class="kw">data</span><span class="kw">=</span><span class="no">glucose</span>, <span class="kw">factor.name</span><span class="kw">=</span><span class="st">"DOSE"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">glucose.ctp</span>)
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : GLUCOSE.CHANGE ~ GLUCOSE.BLA + DOSE , test : F </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=PLACEBO, 2=LOW, 3=MEDIUM, 4=HIGH </span>
<span class="co">## </span>
<span class="co">## Hypotheses and p-values</span>
<span class="co">## -----------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis Level raw p-value adj. p-value</span>
<span class="co">##        [12]     1   6.033e-02    6.033e-02</span>
<span class="co">##        [13]     1   7.086e-05    3.536e-04</span>
<span class="co">##        [14]     1   6.917e-05    3.464e-04</span>
<span class="co">##       [123]     2   3.536e-04    3.536e-04</span>
<span class="co">##       [124]     2   3.464e-04    3.464e-04</span>
<span class="co">##       [134]     2   2.407e-05    7.375e-05</span>
<span class="co">##      [1234]     3   7.375e-05    7.375e-05</span>
<span class="fu"><a href="../reference/Generic_functions.html">Display</a></span>(<span class="no">glucose.ctp</span>,<span class="kw">Type</span><span class="kw">=</span><span class="st">"s"</span>)</pre></body></html></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-10-1.png" width="100%"></p>
</div>
<div id="large-hypothesis-trees" class="section level2">
<h2 class="hasAnchor">
<a href="#large-hypothesis-trees" class="anchor"></a>Large hypothesis trees</h2>
<p>Whith an increasing number of hypotheses to test, the graphical display may become quite confusing:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">G</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fl">5</span>,<span class="kw">each</span><span class="kw">=</span><span class="fl">4</span>) )
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">20</span>)
<span class="no">Y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">G</span>,<span class="no">y</span>)

<span class="no">xxx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/IntersectHypotheses.html">IntersectHypotheses</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fl">1</span>:<span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>),<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">4</span>),<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">5</span>),<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">5</span>),<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">4</span>)))
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">xxx</span>)
<span class="co">## New names:</span>
<span class="co">## * hyp.no -&gt; hyp.no...2</span>
<span class="co">## * hyp.no -&gt; hyp.no...5</span>
<span class="co">## </span>
<span class="co">## Hypotheses to be tested </span>
<span class="co">## =======================</span>
<span class="co">## </span>
<span class="co">##  hyp.no level hypothesis.name</span>
<span class="co">##       1     1            [12]</span>
<span class="co">##       2     1            [13]</span>
<span class="co">##       3     1            [14]</span>
<span class="co">##       4     1            [15]</span>
<span class="co">##       5     1            [25]</span>
<span class="co">##       6     1            [34]</span>
<span class="co">##       1     2           [123]</span>
<span class="co">##       2     2           [124]</span>
<span class="co">##       3     2           [125]</span>
<span class="co">##       4     2        [12][34]</span>
<span class="co">##       5     2           [134]</span>
<span class="co">##       6     2           [135]</span>
<span class="co">##       7     2        [13][25]</span>
<span class="co">##       8     2           [145]</span>
<span class="co">##       9     2        [14][25]</span>
<span class="co">##      10     2        [15][34]</span>
<span class="co">##      11     2        [25][34]</span>
<span class="co">##       1     3          [1234]</span>
<span class="co">##       2     3          [1235]</span>
<span class="co">##       3     3         [12345]</span>
<span class="co">##       4     3          [1245]</span>
<span class="co">##       5     3       [125][34]</span>
<span class="co">##       6     3          [1345]</span>
<span class="co">##       7     3       [134][25]</span>
<span class="co">##       1     4         [12345]</span>
<span class="co">## </span>
<span class="co">## Connection structure of the hypotheses </span>
<span class="co">## ======================================</span>
<span class="co">## </span>
<span class="co">##  Level            Connection</span>
<span class="co">##      1         [12] -&gt; [123]</span>
<span class="co">##      1         [12] -&gt; [124]</span>
<span class="co">##      1         [12] -&gt; [125]</span>
<span class="co">##      1      [12] -&gt; [12][34]</span>
<span class="co">##      1         [13] -&gt; [123]</span>
<span class="co">##      1         [13] -&gt; [134]</span>
<span class="co">##      1         [13] -&gt; [135]</span>
<span class="co">##      1      [13] -&gt; [13][25]</span>
<span class="co">##      1         [14] -&gt; [124]</span>
<span class="co">##      1         [14] -&gt; [134]</span>
<span class="co">##      1         [14] -&gt; [145]</span>
<span class="co">##      1      [14] -&gt; [14][25]</span>
<span class="co">##      1         [15] -&gt; [125]</span>
<span class="co">##      1         [15] -&gt; [135]</span>
<span class="co">##      1         [15] -&gt; [145]</span>
<span class="co">##      1      [15] -&gt; [15][34]</span>
<span class="co">##      1         [25] -&gt; [125]</span>
<span class="co">##      1      [25] -&gt; [13][25]</span>
<span class="co">##      1      [25] -&gt; [14][25]</span>
<span class="co">##      1      [25] -&gt; [25][34]</span>
<span class="co">##      1      [34] -&gt; [12][34]</span>
<span class="co">##      1         [34] -&gt; [134]</span>
<span class="co">##      1      [34] -&gt; [15][34]</span>
<span class="co">##      1      [34] -&gt; [25][34]</span>
<span class="co">##      2    [12][34] -&gt; [1234]</span>
<span class="co">##      2   [12][34] -&gt; [12345]</span>
<span class="co">##      2 [12][34] -&gt; [125][34]</span>
<span class="co">##      2       [123] -&gt; [1234]</span>
<span class="co">##      2       [123] -&gt; [1235]</span>
<span class="co">##      2      [123] -&gt; [12345]</span>
<span class="co">##      2       [124] -&gt; [1234]</span>
<span class="co">##      2      [124] -&gt; [12345]</span>
<span class="co">##      2       [124] -&gt; [1245]</span>
<span class="co">##      2       [125] -&gt; [1235]</span>
<span class="co">##      2      [125] -&gt; [12345]</span>
<span class="co">##      2       [125] -&gt; [1245]</span>
<span class="co">##      2    [125] -&gt; [125][34]</span>
<span class="co">##      2    [13][25] -&gt; [1235]</span>
<span class="co">##      2   [13][25] -&gt; [12345]</span>
<span class="co">##      2 [13][25] -&gt; [134][25]</span>
<span class="co">##      2       [134] -&gt; [1234]</span>
<span class="co">##      2      [134] -&gt; [12345]</span>
<span class="co">##      2       [134] -&gt; [1345]</span>
<span class="co">##      2    [134] -&gt; [134][25]</span>
<span class="co">##      2       [135] -&gt; [1235]</span>
<span class="co">##      2      [135] -&gt; [12345]</span>
<span class="co">##      2       [135] -&gt; [1345]</span>
<span class="co">##      2   [14][25] -&gt; [12345]</span>
<span class="co">##      2    [14][25] -&gt; [1245]</span>
<span class="co">##      2 [14][25] -&gt; [134][25]</span>
<span class="co">##      2      [145] -&gt; [12345]</span>
<span class="co">##      2       [145] -&gt; [1245]</span>
<span class="co">##      2       [145] -&gt; [1345]</span>
<span class="co">##      2   [15][34] -&gt; [12345]</span>
<span class="co">##      2 [15][34] -&gt; [125][34]</span>
<span class="co">##      2    [15][34] -&gt; [1345]</span>
<span class="co">##      2   [25][34] -&gt; [12345]</span>
<span class="co">##      2 [25][34] -&gt; [125][34]</span>
<span class="co">##      2 [25][34] -&gt; [134][25]</span>
<span class="co">##      3     [1234] -&gt; [12345]</span>
<span class="co">##      3    [12345] -&gt; [12345]</span>
<span class="co">##      3     [1235] -&gt; [12345]</span>
<span class="co">##      3     [1245] -&gt; [12345]</span>
<span class="co">##      3  [125][34] -&gt; [12345]</span>
<span class="co">##      3  [134][25] -&gt; [12345]</span>
<span class="co">##      3     [1345] -&gt; [12345]</span>
<span class="fu"><a href="../reference/Generic_functions.html">Display</a></span>(<span class="no">xxx</span>)</pre></body></html></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-11-1.png" width="100%"></p>
</div>
<div id="external-p-values" class="section level2">
<h2 class="hasAnchor">
<a href="#external-p-values" class="anchor"></a>“External” p-values</h2>
<p>It is possible to use:</p>
<ul>
<li>
<strong>IntersectHypotheses</strong> to create the closure set and <strong>Display</strong> to plot the corresponding hypothesis tree.</li>
<li>Calculate the p-values for the local hypotheses with other functions or software.</li>
<li>Import these p-values.</li>
<li>Use <strong>Adjust_raw</strong> to calculte the adjusted p- values. <strong>Adjust_raw</strong> delivers an object of class <strong>ctp</strong>.</li>
<li>Use <strong>summary</strong> and <strong>Display</strong> on this object.</li>
</ul>
<div class="sourceCode" id="cb17"><html><body><pre class="r">    <span class="no">xxx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/IntersectHypotheses.html">IntersectHypotheses</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fl">1</span>:<span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>),<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">4</span>)))
  <span class="no">xxx</span>$<span class="no">hypothesis</span>
<span class="co">## [[1]]</span>
<span class="co">## [[1]][[1]]</span>
<span class="co">## [1] 1 2</span>
<span class="co">## </span>
<span class="co">## [[1]][[2]]</span>
<span class="co">## [1] 1 3</span>
<span class="co">## </span>
<span class="co">## [[1]][[3]]</span>
<span class="co">## [1] 1 4</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## [[2]]</span>
<span class="co">## [[2]][[1]]</span>
<span class="co">## [1] 1 2 3</span>
<span class="co">## </span>
<span class="co">## [[2]][[2]]</span>
<span class="co">## [1] 1 2 4</span>
<span class="co">## </span>
<span class="co">## [[2]][[3]]</span>
<span class="co">## [1] 1 3 4</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## [[3]]</span>
<span class="co">## [[3]][[1]]</span>
<span class="co">## [1] 1 2 3 4</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">xxx</span>$<span class="no">hypnames</span>)
<span class="co">##   hyp.no level hypothesis.name</span>
<span class="co">## 1      1     1            [12]</span>
<span class="co">## 2      2     1            [13]</span>
<span class="co">## 3      3     1            [14]</span>
<span class="co">## 4      1     2           [123]</span>
<span class="co">## 5      2     2           [124]</span>
<span class="co">## 6      3     2           [134]</span>
<span class="co">## 7      1     3          [1234]</span>
  <span class="no">xxx</span>$<span class="no">hypnames</span>
<span class="co">##   hyp.no level hypothesis.name</span>
<span class="co">## 1      1     1            [12]</span>
<span class="co">## 2      2     1            [13]</span>
<span class="co">## 3      3     1            [14]</span>
<span class="co">## 4      1     2           [123]</span>
<span class="co">## 5      2     2           [124]</span>
<span class="co">## 6      3     2           [134]</span>
<span class="co">## 7      1     3          [1234]</span>
  <span class="no">p.val</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>,<span class="fl">0.04</span>,<span class="fl">0.02</span>,<span class="fl">0.08</span>,<span class="fl">0.03</span>,<span class="fl">0.03</span>,<span class="fl">0.04</span>)

  <span class="fu"><a href="../reference/Adjust_raw.html">Adjust_raw</a></span>(<span class="no">xxx</span>, <span class="no">p.val</span>)
<span class="co">## $CTPparms</span>
<span class="co">## $CTPparms$hyplist</span>
<span class="co">## $CTPparms$hyplist[[1]]</span>
<span class="co">## $CTPparms$hyplist[[1]][[1]]</span>
<span class="co">## [1] 1 2</span>
<span class="co">## </span>
<span class="co">## $CTPparms$hyplist[[1]][[2]]</span>
<span class="co">## [1] 1 3</span>
<span class="co">## </span>
<span class="co">## $CTPparms$hyplist[[1]][[3]]</span>
<span class="co">## [1] 1 4</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $CTPparms$hyplist[[2]]</span>
<span class="co">## $CTPparms$hyplist[[2]][[1]]</span>
<span class="co">## [1] 1 2 3</span>
<span class="co">## </span>
<span class="co">## $CTPparms$hyplist[[2]][[2]]</span>
<span class="co">## [1] 1 2 4</span>
<span class="co">## </span>
<span class="co">## $CTPparms$hyplist[[2]][[3]]</span>
<span class="co">## [1] 1 3 4</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $CTPparms$hyplist[[3]]</span>
<span class="co">## $CTPparms$hyplist[[3]][[1]]</span>
<span class="co">## [1] 1 2 3 4</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $CTPparms$hypnames</span>
<span class="co">##   hyp.no level hypothesis.name pvalue</span>
<span class="co">## 1      1     1            [12]   0.05</span>
<span class="co">## 2      2     1            [13]   0.04</span>
<span class="co">## 3      3     1            [14]   0.02</span>
<span class="co">## 4      1     2           [123]   0.08</span>
<span class="co">## 5      2     2           [124]   0.03</span>
<span class="co">## 6      3     2           [134]   0.03</span>
<span class="co">## 7      1     3          [1234]   0.04</span>
<span class="co">## </span>
<span class="co">## $CTPparms$connections</span>
<span class="co">## $CTPparms$connections[[1]]</span>
<span class="co">##   hypold hypnew levold levnew</span>
<span class="co">## 1      1      1      1      2</span>
<span class="co">## 2      2      1      1      2</span>
<span class="co">## 3      1      2      1      2</span>
<span class="co">## 4      3      2      1      2</span>
<span class="co">## 5      2      3      1      2</span>
<span class="co">## 6      3      3      1      2</span>
<span class="co">## </span>
<span class="co">## $CTPparms$connections[[2]]</span>
<span class="co">##   hypold hypnew levold levnew</span>
<span class="co">## 1      1      1      2      3</span>
<span class="co">## 2      2      1      2      3</span>
<span class="co">## 3      3      1      2      3</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $CTPparms$model</span>
<span class="co">## NULL</span>
<span class="co">## </span>
<span class="co">## $CTPparms$lm.obj</span>
<span class="co">## NULL</span>
<span class="co">## </span>
<span class="co">## $CTPparms$data</span>
<span class="co">## NULL</span>
<span class="co">## </span>
<span class="co">## $CTPparms$test</span>
<span class="co">## [1] "ctp."</span>
<span class="co">## </span>
<span class="co">## $CTPparms$fac</span>
<span class="co">## NULL</span>
<span class="co">## </span>
<span class="co">## $CTPparms$facname</span>
<span class="co">## NULL</span>
<span class="co">## </span>
<span class="co">## $CTPparms$level</span>
<span class="co">## NULL</span>
<span class="co">## </span>
<span class="co">## $CTPparms$nlevel</span>
<span class="co">## [1] 0</span>
<span class="co">## </span>
<span class="co">## $CTPparms$resp</span>
<span class="co">## NULL</span>
<span class="co">## </span>
<span class="co">## $CTPparms$respname</span>
<span class="co">## [1] ""</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $pvalues</span>
<span class="co">##   hyp.no level hypothesis.name pvalue pvalue.adj</span>
<span class="co">## 1      1     1            [12]   0.05       0.08</span>
<span class="co">## 2      2     1            [13]   0.04       0.08</span>
<span class="co">## 3      3     1            [14]   0.02       0.04</span>
<span class="co">## 4      1     2           [123]   0.08       0.08</span>
<span class="co">## 5      2     2           [124]   0.03       0.04</span>
<span class="co">## 6      3     2           [134]   0.03       0.04</span>
<span class="co">## 7      1     3          [1234]   0.04       0.04</span>
<span class="co">## </span>
<span class="co">## $info</span>
<span class="co">## NULL</span>
<span class="co">## </span>
<span class="co">## attr(,"class")</span>
<span class="co">## [1] "ctp"</span>
    <span class="co"># the vector of p-values calculated by another software</span>
    <span class="co"># you may supply the hypothesis names as names of the vector</span>

  <span class="no">result</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/Adjust_raw.html">Adjust_raw</a></span>(<span class="kw">ctp.struc</span><span class="kw">=</span><span class="no">three.to.first</span>, <span class="kw">p.value</span><span class="kw">=</span><span class="no">p.val</span>)

    <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">result</span>)
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Hypotheses and p-values</span>
<span class="co">## -----------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis Level raw p-value adj. p-value</span>
<span class="co">##        [12]     1        0.05         0.08</span>
<span class="co">##        [13]     1        0.04         0.08</span>
<span class="co">##        [14]     1        0.02         0.04</span>
<span class="co">##       [123]     2        0.08         0.08</span>
<span class="co">##       [124]     2        0.03         0.04</span>
<span class="co">##       [134]     2        0.03         0.04</span>
<span class="co">##      [1234]     3        0.04         0.04</span>

    <span class="co"># details may be documented</span>

    <span class="no">result</span><span class="kw">&lt;-</span><span class="fu"><a href="../reference/Adjust_raw.html">Adjust_raw</a></span>(<span class="kw">ctp.struc</span><span class="kw">=</span><span class="no">three.to.first</span>, <span class="kw">p.value</span><span class="kw">=</span><span class="no">p.val</span>
              ,<span class="kw">dataset.name</span><span class="kw">=</span><span class="st">"mydata"</span>, <span class="kw">factor.name</span><span class="kw">=</span><span class="st">"treatment"</span>
              ,<span class="kw">factor.levels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span>), <span class="kw">model</span><span class="kw">=</span><span class="no">y</span>~<span class="no">treatment</span>
              ,<span class="kw">test.name</span><span class="kw">=</span><span class="st">"F"</span>)

    <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">result</span>)
<span class="co">## </span>
<span class="co">## Summary of Closed Testing Procedure</span>
<span class="co">## ===================================</span>
<span class="co">## </span>
<span class="co">## Model : y ~ treatment , test : F </span>
<span class="co">## </span>
<span class="co">## Factor levels: 1=A, 2=B, 3=C, 4=D </span>
<span class="co">## </span>
<span class="co">## Hypotheses and p-values</span>
<span class="co">## -----------------------</span>
<span class="co">## </span>
<span class="co">##  Hypothesis Level raw p-value adj. p-value</span>
<span class="co">##        [12]     1        0.05         0.08</span>
<span class="co">##        [13]     1        0.04         0.08</span>
<span class="co">##        [14]     1        0.02         0.04</span>
<span class="co">##       [123]     2        0.08         0.08</span>
<span class="co">##       [124]     2        0.03         0.04</span>
<span class="co">##       [134]     2        0.03         0.04</span>
<span class="co">##      [1234]     3        0.04         0.04</span>
    <span class="fu"><a href="../reference/Generic_functions.html">Display</a></span>(<span class="no">result</span>)</pre></body></html></div>
<p><img src="closed_testing_procedure_files/figure-html/unnamed-chunk-12-1.png" width="100%"></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Bauer1991">
<p>Bauer, Peter. 1991. “Multiple Testing in Clinical Trials.” <em>Statistics in Medicine</em> 10 (4): 261–63.</p>
</div>
<div id="ref-Bretz2011">
<p>Bretz, Frank, Hothorn, T., and Westfall,P. 2011. <em>Multiple Comparisons Using R</em>. CRC Press.</p>
</div>
<div id="ref-Dmit2010">
<p>Dmitrienko, Alex, Tamhane, A., and Bretz, F. 2010. <em>Multiple Testing Problems in Pharmaceutical Statistics</em>. Chapman &amp; Hall.</p>
</div>
<div id="ref-Gabriel1976">
<p>Marcus, Ruth, Peritz, E., and Gabriel, K.R. 1976. “On Closed Testing Procedures with Special Reference to Ordered Analysis of Variance.” <em>Biometrika</em> 63: 655–60.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Paul Jordan, Herpers Matthias.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
